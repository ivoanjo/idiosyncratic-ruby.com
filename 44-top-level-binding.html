<!doctype html>
<html>
  <head>
    <title>Idiosyncratic Ruby: Top Level Binding</title>
    <link rel="alternate" type="application/atom+xml" title="Idiosyncratic Ruby Feed" href="/feed.xml" />
<link href="/stylesheets/all.css" rel="stylesheet" type="text/css" />

<script src="/javascripts/jquery.min.js" type="text/javascript"></script><script src="/javascripts/app.js" type="text/javascript"></script>

<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta name="description" content="Documenting All Ruby Specialities."/>
<meta name="keywords" content="ruby, core, stdlib"/>

  </head>

  <body>
    <div class="world">
      <section class="post-header">
        <a href="/" class="post-logo"><img src="/images/idiosyncratic.png" alt="Idiosyncratic Ruby"></a>
        <h1 class="post-heading" id="top"><a href="/44-top-level-binding.html">Top Level Binding</a></h1>
      </section>

      <article class="post">
        <p>In case you have wondered, what this top-level constant <code>TOPLEVEL_BINDING</code> is all about:</p>

<p></p>

<p>It is, as its name suggest, the <a href="https://ruby-doc.org/core/Binding.html">Binding</a> of your script's main scope:</p>

<pre><code>a = 42
p binding.local_variable_defined?(:a) # =&gt; true
p TOPLEVEL_BINDING.local_variable_defined?(:a) # =&gt; true

def example_method
  p binding.local_variable_defined?(:a) # =&gt; false
  p TOPLEVEL_BINDING.local_variable_defined?(:a) # =&gt; true
end

example_method
</code></pre>

<h2 id="what-is-a-practical-use-of-it">What is a practical use of it?</h2>

<p>Besides being a general default binding for your application (<a href="https://github.com/ruby/ruby/blob/v2_3_1/lib/irb.rb#L373">which is used in IRB</a>), it can act also as the missing <code>Binding.new</code>:</p>

<pre><code>clean_binding = TOPLEVEL_BINDING.dup
</code></pre>

<p>Assuming a more complex/structured application (instead of a single-file script), the top-level binding is mostly empty or consists of just a few important variables.</p>

<p>In fact, this is how <a href="https://github.com/ruby/ruby/blob/v2_3_1/lib/erb.rb#L872-L875">it is utilized in stdlib's ERB implementation</a>.</p>


        <h2>More Idiosyncratic Ruby</h2>
        <ul>
          <li><a href="https://github.com/janlelis/idiosyncratic-ruby.com/commit/ff31100be1571930bbefd4d86de9d8323b86b0dc#all_commit_comments">Please Comment on GitHub</a></li>
            <li>Next Article: <a href="/45-constant-shuffle.html">Constant Shuffle</a></li>
            <li>Previous Article: <a href="/43-new-ruby-startup.html">New Ruby Startup</a></li>
        </ul>
      </article>

      <footer>
        <div class="footer-right">
          On <a href="/">Idiosyncratic Ruby</a> by <a href="https://janlelis.com">Jan Lelis</a><br>
          
          <a href="https://janlelis.com/data-protection.html">Data Protection</a>
        </div>
        About Core, Stdlib<br>
        Last Update: December 25, 2017
      </footer>
    </div>
    <script src="/javascripts/rainbow-custom.min.js" type="text/javascript"></script>
  </body>
</html>