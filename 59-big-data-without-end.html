<!doctype html>
<html>
  <head>
    <title>Idiosyncratic Ruby: Big Data Without End</title>
    <link rel="alternate" type="application/atom+xml" title="Idiosyncratic Ruby Feed" href="/feed.xml" />
<link href="/stylesheets/all.css" rel="stylesheet" type="text/css" />

<script src="/javascripts/jquery.min.js" type="text/javascript"></script><script src="/javascripts/app.js" type="text/javascript"></script>

<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta name="description" content="Documenting All Ruby Specialities."/>
<meta name="keywords" content="ruby, core, syntax, keywords"/>

  </head>

  <body>
    <div class="world">
      <section class="post-header">
        <a href="/" class="post-logo"><img src="/images/idiosyncratic.png" alt="Idiosyncratic Ruby"></a>
        <h1 class="post-heading" id="top"><a href="/59-big-data-without-end.html">Big Data Without End</a></h1>
      </section>

      <article class="post">
        <p>Ruby's big <code>DATA</code> constant does more than you might expect!</p>

<p></p>

<p>Everything after the <code>__END__</code> keyword (at the beginning of the line) is not interpreted as Ruby, but can be retrieved with the big¹ <code>DATA</code> constant.² This is an example <code>big-data.rb</code> script:</p>

<pre><code>p DATA.read
__END__
big data
</code></pre>

<p>Big <code>DATA</code> is a <a href="https://ruby-doc.org/core/File.html">File</a> object, which you can <code>read</code>. The example will output <code>"big data"</code>. An example of real-world usage is <a href="http://www.sinatrarb.com/intro.html#Inline%20Templates">inline templating within the sinatra web framework</a>.³</p>

<p>¹ Do not confuse with the small <code>Data</code> class, which is a <a href="https://ruby-doc.org/core/Data.html">CRuby implementation detail</a><br />
² Big <code>DATA</code> <a href="/53-the-constant-tree.html">is not defined</a>, if you have no <code>__END__</code>. Furthermore, it is not available if you did not execute the script directly, but loaded or required it.<br />
³ <a href="http://blog.honeybadger.io/data-and-end-in-ruby/#a-work-around-for-multiple-files">Actually, not really</a></p>

<h2 id="is-the-data-section-enough">Is the Data Section Enough?</h2>

<p>Wait a minute! Big <code>DATA</code> is a <a href="https://ruby-doc.org/core/File.html">File</a> object? What file exactly?</p>

<pre><code>p DATA.path
p DATA.lineno
__END__
big data
</code></pre>

<p>The output will be <code>"big-data.rb"</code> and <code>3</code>. The big <code>DATA</code> object points to the source file itself at a specific position! And look, we can alter this:</p>

<pre><code>DATA.rewind
puts DATA.gets("\n__END__")[0..-9]
__END__
big data
</code></pre>

<p>It will now read the source code of itself:</p>

<pre><code>DATA.rewind
puts DATA.gets("\n__END__")[0..-9]
</code></pre>

<h2 id="also-see">Also See</h2>

<ul>
  <li><a href="/22-literate-ruby.html"><code>$ ruby -x</code></a></li>
  <li><a href="/5-constant-shadows.html"><code>SCRIPT_LINES__</code></a></li>
</ul>


        <h2>More Idiosyncratic Ruby</h2>
        <ul>
          <li><a href="https://github.com/janlelis/idiosyncratic-ruby.com/commit/344413c1e03d975b0955f643998d40f4d22282cc#all_commit_comments">Please Comment on GitHub</a></li>
            <li>Next Article: <a href="/60-escape-back-referencing.html">Escape Back Referencing</a></li>
            <li>Previous Article: <a href="/58-magic-instructions.html">Magic Instructions</a></li>
        </ul>
      </article>

      <footer>
        <div class="footer-right">
          On <a href="/">Idiosyncratic Ruby</a> by <a href="https://janlelis.com">Jan Lelis</a><br>
          Article Contributions by: Yauheni Dakuka<br>
          <a href="https://janlelis.com/data-protection.html">Data Protection</a>
        </div>
        About Core, Syntax, Keywords<br>
        Last Update: August 22, 2018
      </footer>
    </div>
    <script src="/javascripts/rainbow-custom.min.js" type="text/javascript"></script>
  </body>
</html>